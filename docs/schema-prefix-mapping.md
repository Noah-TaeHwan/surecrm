# ğŸ—ï¸ ìŠ¤í‚¤ë§ˆ Prefix ë§¤í•‘ ê°€ì´ë“œ

## ğŸ“‹ **í…Œì´ë¸” ì´ë¦„ ë³€ê²½ ë§¤í•‘**

### ğŸš€ **App ë¹„ì¦ˆë‹ˆìŠ¤ í…Œì´ë¸”ë“¤ (`app_` prefix)**

| ê¸°ì¡´ í…Œì´ë¸”ëª…     | ìƒˆ í…Œì´ë¸”ëª…           | ìš©ë„            |
| ----------------- | --------------------- | --------------- |
| `profiles`        | `app_profiles`        | ì‚¬ìš©ì í”„ë¡œí•„   |
| `teams`           | `app_teams`           | íŒ€ ê´€ë¦¬         |
| `clients`         | `app_clients`         | ê³ ê° ì •ë³´       |
| `client_details`  | `app_client_details`  | ê³ ê° ìƒì„¸ ì •ë³´  |
| `insurance_info`  | `app_insurance_info`  | ë³´í—˜ ì •ë³´       |
| `referrals`       | `app_referrals`       | ì†Œê°œ ê´€ê³„       |
| `meetings`        | `app_meetings`        | ë¯¸íŒ… ê´€ë¦¬       |
| `invitations`     | `app_invitations`     | ì´ˆëŒ€ì¥ ê´€ë¦¬     |
| `documents`       | `app_documents`       | ë¬¸ì„œ ê´€ë¦¬       |
| `pipeline_stages` | `app_pipeline_stages` | íŒŒì´í”„ë¼ì¸ ë‹¨ê³„ |

### ğŸŒ **Public í˜ì´ì§€ í…Œì´ë¸”ë“¤ (`public_` prefix)**

| ê¸°ì¡´ í…Œì´ë¸”ëª…     | ìƒˆ í…Œì´ë¸”ëª…            | ìš©ë„                    |
| ----------------- | ---------------------- | ----------------------- |
| `public_contents` | `public_contents`      | ê³µê°œ ì½˜í…ì¸  (ë³€ê²½ ì—†ìŒ) |
| `faqs`            | `public_faqs`          | FAQ                     |
| `announcements`   | `public_announcements` | ê³µì§€ì‚¬í•­                |
| `testimonials`    | `public_testimonials`  | ê³ ê° í›„ê¸°               |
| `site_settings`   | `public_site_settings` | ì‚¬ì´íŠ¸ ì„¤ì •             |
| `page_views`      | `public_page_views`    | í˜ì´ì§€ ì¡°íšŒìˆ˜           |

### ğŸ”’ **Admin ë°±ì˜¤í”¼ìŠ¤ í…Œì´ë¸”ë“¤ (`admin_` prefix)**

| í…Œì´ë¸”ëª…            | ìš©ë„              | ìƒíƒœ         |
| ------------------- | ----------------- | ------------ |
| `admin_audit_logs`  | Admin ê°ì‚¬ ë¡œê·¸   | âœ… ì‹ ê·œ ìƒì„± |
| `admin_settings`    | Admin ì‹œìŠ¤í…œ ì„¤ì • | âœ… ì‹ ê·œ ìƒì„± |
| `admin_stats_cache` | Admin í†µê³„ ìºì‹œ   | âœ… ì‹ ê·œ ìƒì„± |

## ğŸ›¡ï¸ **RLS ì •ì±… ì ìš© í˜„í™©**

### App í…Œì´ë¸”ë“¤

- **ì ‘ê·¼ ì›ì¹™**: ì‚¬ìš©ìëŠ” ìì‹ ì˜ ë°ì´í„°ë§Œ ì ‘ê·¼ ê°€ëŠ¥
- **Admin ì ‘ê·¼**: `system_admin` ì—­í• ì€ ëª¨ë“  ë°ì´í„° ì ‘ê·¼ ê°€ëŠ¥
- **íŒ€ ê³µìœ **: íŒ€ ê¸°ë°˜ ë°ì´í„°ëŠ” íŒ€ ë©¤ë²„ë¼ë¦¬ ê³µìœ 

### Public í…Œì´ë¸”ë“¤

- **ì½ê¸° ì ‘ê·¼**: ëª¨ë“  ì‚¬ìš©ìê°€ `is_published=true` ë°ì´í„° ì½ê¸° ê°€ëŠ¥
- **ê´€ë¦¬ ì ‘ê·¼**: `system_admin`ë§Œ CRUD ê°€ëŠ¥

### Admin í…Œì´ë¸”ë“¤

- **ì™„ì „ ì œí•œ**: `system_admin` ì—­í• ë§Œ ëª¨ë“  ì‘ì—… ê°€ëŠ¥
- **ê°ì‚¬ ë¡œê¹…**: ëª¨ë“  ì ‘ê·¼ ì‹œë„ ê¸°ë¡

## ğŸ“‚ **íŒŒì¼ ë³€ê²½ ì‚¬í•­**

### ìŠ¤í‚¤ë§ˆ íŒŒì¼ë“¤

- âœ… `app/lib/schema/core.ts` - App í…Œì´ë¸”ëª… ì—…ë°ì´íŠ¸
- âœ… `app/lib/schema/public.ts` - Public í…Œì´ë¸”ëª… ì—…ë°ì´íŠ¸
- âœ… `app/lib/schema/index.ts` - í†µí•© ìŠ¤í‚¤ë§ˆ ë° íŠ¸ë¦¬ê±° ì—…ë°ì´íŠ¸

### ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ë“¤

- âœ… `supabase/migrations/20241219000001_add_admin_tables.sql` - Admin í…Œì´ë¸” ìƒì„±
- âœ… `supabase/migrations/20241219000002_rename_tables_with_prefixes.sql` - í…Œì´ë¸”ëª… ë³€ê²½

### Admin í˜ì´ì§€ë“¤

- âœ… `app/features/admin/pages/*.tsx` - ë©”ì¸ ìŠ¤í‚¤ë§ˆ importë¡œ ë³€ê²½
- âœ… `app/features/admin/lib/utils.ts` - ë©”ì¸ ìŠ¤í‚¤ë§ˆ ì‚¬ìš©

## ğŸš€ **ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰ ë°©ë²•**

```bash
# 1. Admin í…Œì´ë¸” ìƒì„±
supabase db push

# 2. í…Œì´ë¸”ëª… ë³€ê²½ ì ìš©
# (ìœ„ì˜ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ë“¤ì´ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ë¨)

# 3. ìŠ¤í‚¤ë§ˆ í™•ì¸
supabase db diff
```

## âœ… **ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸**

- [x] App í…Œì´ë¸”ë“¤ `app_` prefix ì ìš©
- [x] Public í…Œì´ë¸”ë“¤ `public_` prefix ì ìš©
- [x] Admin í…Œì´ë¸”ë“¤ `admin_` prefix ì ìš© (ì‹ ê·œ)
- [x] RLS ì •ì±… ì—…ë°ì´íŠ¸
- [x] ì¸ë±ìŠ¤ ì¬ìƒì„±
- [x] íŠ¸ë¦¬ê±° í•¨ìˆ˜ ì—…ë°ì´íŠ¸
- [x] Auth ì—°ë™ íŠ¸ë¦¬ê±° ì—…ë°ì´íŠ¸
- [x] Admin í˜ì´ì§€ import ê²½ë¡œ ìˆ˜ì •

## ğŸ¯ **ê´€ë¦¬ íš¨ê³¼**

1. **ëª…í™•í•œ ë¶„ë¥˜**: í…Œì´ë¸” ìš©ë„ë¥¼ prefixë¡œ ì¦‰ì‹œ íŒŒì•… ê°€ëŠ¥
2. **ë³´ì•ˆ ê°•í™”**: Admin/Public/App ì˜ì—­ ëª…í™•íˆ ë¶„ë¦¬
3. **ìœ ì§€ë³´ìˆ˜ ê°œì„ **: í…Œì´ë¸” ê·¸ë£¹ë³„ ê´€ë¦¬ ë° ë°±ì—… ì „ëµ ìˆ˜ë¦½ ìš©ì´
4. **í™•ì¥ì„±**: ìƒˆë¡œìš´ ê¸°ëŠ¥ ì˜ì—­ ì¶”ê°€ ì‹œ prefix ê·œì¹™ ì ìš© ê°€ëŠ¥
